#!/bin/bash

# Select emoji using fuzzel
emoji=$(cat ~/.config/hypr/scripts/emoji-list.txt | fuzzel --dmenu -p "Emoji: " | awk '{print $1}')

if [ -n "$emoji" ]; then
    # Copy to clipboard
    echo -n "$emoji" | wl-copy
    
    # Get the active window class
    active_window_class=$(hyprctl activewindow -j | jq -r '.class')
    
    # Determine if we should use wtype or paste from clipboard
    if [[ "$active_window_class" == *"chrome"* ]] || 
       [[ "$active_window_class" == *"electron"* ]] || 
       [[ "$active_window_class" == *"discord"* ]] || 
       [[ "$active_window_class" == *"Code"* ]]; then
        # For XWayland apps, use clipboard paste
        sleep 0.5
        wtype -k ctrl v
    else
        # For native Wayland apps, use direct typing
        sleep 0.5
        wtype "$emoji"
    fi
    
    # Notify user
    notify-send "Emoji" "$emoji inserted" -t 2000
fi
